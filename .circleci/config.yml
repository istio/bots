version: 2
jobs:
  build_dashboard:
    docker:
      - image: gcr.io/istio-testing/website-builder:2019-05-03

    working_directory: ~/site/dashboard

    steps:
      - checkout

      - run:
          name: Building Dashboard
          command: scripts/build_site.sh

      - run:
          name: Generating Dashboard
          command: scripts/gen_site.sh "" -no_minify

      - run:
          name: Running Linters
          command: scripts/lint_site.sh

  lint:
    working_directory: ~/site

    steps:
      - checkout

      - run:
          name: Linting
          command: scripts/linters.sh
